<% content_for :title do %>
  Search - Â¿Who Knows?
<% end %>

<div>
  <input id="search-input" placeholder="Search..." value="<%= params[:q] || '' %>"/>
  <button id="search-button" onclick="makeSearchRequest()">Search</button>
</div>

<div id="results">
  <% if defined?(search_results) && search_results %>
    <% search_results.each do |result| %>
      <div>
        <h2><a class="search-result-title" href="<%= result[:url] %>"><%= result[:title] %></a></h2>
        <p class="search-result-description"><%= result[:description] %></p>
      </div>
    <% end %>
  <% end %>
</div>

<script>
  let searchInput;

  document.addEventListener('DOMContentLoaded', () => {
    searchInput = document.getElementById("search-input");

    // Focus the input field
    searchInput.focus();

    // Search when the user presses Enter
    searchInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
          makeSearchRequest();
        }
    });
  });

  function makeSearchRequest() {
    const query = searchInput.value;
    const url = new URL(window.location.href);
    url.searchParams.set('q', query);
    window.location.href = url.toString();
  }
</script>
